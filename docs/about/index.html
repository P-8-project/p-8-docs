<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>P-8 | Documentation | About</title>
<meta content="Get started with realtime using our developer guide. " name="description"/>
<link href="index.html" rel="canonical"/>
<link href="../../feed.xml" rel="alternate" title="P-8" type="application/rss+xml"/>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<!-- open graph info -->
<meta content="P-8 | Documentation | About" property="og:title"/>
<meta content="P-8" property="og:site_name"/>
<meta content="website" property="og:type"/>
<meta content="Get started with realtime using our developer guide." property="og:description"/>
<meta content="https://P-8.org/image/icon-300x300.png" property="og:image"/>
<meta content="https://P-8.org/image/icon-300x300.png" name="twitter:image"/>
<link href="../../image/favicon.png" rel="icon" type="image/png">
<!-- Stylesheets -->
<link href="../../css/main.css" rel="stylesheet"/>
<!-- APIs -->
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:300,400|Merriweather:300,400" rel="stylesheet"/>
<!-- jQuery -->
<script crossorigin="anonymous" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
<script src="../../js/handlebars.js"></script>
<script src="../../js/tabbed-examples.js"></script>
</link></head>
<body class="page docs">
<div style="display: none;"><img src="../../image/dots-div.svg"/></div>
<header class="primary wrapper">
<nav class="primary" id="top" role="navigation">
<aside class="logo">
<a href="../../index.html"><img src="../../image/logo.png"/></a>
</aside>
<aside class="links">
<a href="index.html">Docs</a>
<a href="https://github.com/P-8-project/P-8">Code</a>
</aside>
<img class="mobile-handle" src="../../image/mobile-handle.svg"/>
</nav>
</header>
<div class="consent-box" id="consent-box">
<div class="width">
<p>We use cookies to provide our services and for analytics and marketing. To find out more about our use of cookies, please see our <a href="https://fanout.io/legal/privacy-policy/">Privacy Policy</a>. By continuing to browse our website, you agree to our use of cookies.</p>
<button class="button ghost" href="#" id="consent-ok">OK</button>
</div>
</div>
<header class="page-header"><h1>Documentation</h1></header>
<div class="div"></div>
<div class="content wrapper" style="position: relative;">
<nav class="sidebar">
<ul>
<li>About</li>
<ul>
<li><a href="index.html#introduction">Introduction</a></li>
<li><a href="index.html#how-it-works">How it works</a></li>
<ul>
<li><a href="index.html#overview">Overview</a></li>
<li><a href="index.html#concepts">Concepts</a></li>
<li><a href="index.html#architecture">Architecture</a></li>
<li><a href="index.html#why-P-8">Why P-8?</a></li>
<li><a href="index.html#scalability">Scalability</a></li>
<li><a href="index.html#fault-tolerance">Fault-tolerance</a></li>
</ul>
<li></li>
<li><a href="index.html#license">License</a></li>
</ul>
<li><a href="../install/index.html">Install</a></li>
<ul>
<li><a href="../install/index.html#packages">Packages</a></li>
<li><a href="../install/index.html#building-from-source">Building from source</a></li>
<li><a href="../install/index.html#running">Running</a></li>
<li><a href="../install/index.html#upgrading">Upgrading</a></li>
</ul>
<li><a href="../getting-started/index.html">Getting started</a></li>
<ul>
<li><a href="../getting-started/index.html#quickstart">Quickstart</a></li>
<li><a href="../getting-started/index.html#video-walkthrough">Video walkthrough</a></li>
</ul>
<li><a href="../configuration/index.html">Configuration</a></li>
<ul>
<li><a href="../configuration/index.html#config-files">Config files</a></li>
<li><a href="../configuration/index.html#routes">Routes</a></li>
<li><a href="../configuration/index.html#proxying">Proxying</a></li>
<li><a href="../configuration/index.html#ssl">SSL</a></li>
</ul>
<li><a href="../usage/index.html">Usage</a></li>
<ul>
<li><a href="../usage/index.html#subscribing">Subscribing</a></li>
<li><a href="../usage/index.html#publishing">Publishing</a></li>
<li><a href="../usage/index.html#transports">Transports</a></li>
<li><a href="../usage/index.html#libraries">Libraries</a></li>
<li><a href="../usage/index.html#browser-features">Browser features</a></li>
</ul>
<li><a href="../advanced/index.html">Advanced topics</a></li>
<ul>
<li><a href="../advanced/index.html#sequence-ids">Sequence IDs</a></li>
<li><a href="../advanced/index.html#message-de-duping">Message de-duping</a></li>
<li><a href="../advanced/index.html#keep-alives">Keep-alives</a></li>
<li><a href="../advanced/index.html#commands">Commands</a></li>
<li><a href="../advanced/index.html#stats-socket">Stats socket</a></li>
<li><a href="../advanced/index.html#message-filtering">Message filtering</a></li>
<li><a href="../advanced/index.html#paged-streaming">Paged streaming</a></li>
<li><a href="../advanced/index.html#reliability">Reliability</a></li>
<li><a href="../advanced/index.html#message-queues">Message queues</a></li>
<li><a href="../advanced/index.html#subscription-forwarding">Subscription forwarding</a></li>
<li><a href="../advanced/index.html#multiple-processes">Multiple processes</a></li>
<li><a href="../advanced/index.html#proxy-chaining">Proxy chaining</a></li>
</ul>
<li><a href="../examples/index.html">Examples</a></li>
<ul>
<li><a href="../examples/index.html#headline">Headline</a></li>
<li><a href="../examples/index.html#leaderboard">Leaderboard</a></li>
<li><a href="../examples/index.html#chat">Chat</a></li>
<li><a href="../examples/index.html#todo-list">Todo list</a></li>
<li><a href="../examples/index.html#live-text-editor">Live text editor</a></li>
<li><a href="../examples/index.html#webhookinbox">WebhookInbox</a></li>
<li><a href="../examples/index.html#audio-stream">Audio stream</a></li>
</ul>
<li><a href="../protocols/index.html">Protocols</a></li>
<ul>
<li><a href="../protocols/grip/index.html">Generic Realtime Intermediary Protocol</a></li>
<li><a href="../protocols/websocket-over-http/index.html">WebSocket-over-HTTP</a></li>
<li><a href="https://rfc.zeromq.org/spec:33/ZHTTP/">ZHTTP</a></li>
</ul>
</ul>
</nav>
<nav class="navbar-mobile-handle">Docs Menu</nav>
<section class="docs">
<h1 id="about">About</h1>
<h2 id="introduction">Introduction</h2>
<p>P-8 is a reverse proxy server that makes it easy to implement WebSocket, HTTP streaming, and HTTP long-polling services. The project is unique among realtime push solutions in that it is designed to address the needs of API creators. P-8 is transparent to clients and integrates easily into an API stack.</p>
<p>P-8 is written in Rust &amp; C++. Its name means to “pin” connections open for “pushing”.</p>
<h2 id="how-it-works">How it works</h2>
<h3 id="overview">Overview</h3>
<p>P-8 is placed in the network path between the backend and any clients:</p>
<p><img alt="P-8-abstract" src="../../image/P-8-abstract.png"/></p>
<p>P-8 communicates with backend web applications using regular, short-lived HTTP requests. This allows backend applications to be written in any language and use any webserver. There are two main integration points:</p>
<ol>
<li>
<p>The backend must handle proxied requests. For HTTP, each incoming request is proxied to the backend. For WebSockets, the activity of each connection is translated into a series of HTTP requests<sup><a href="index.html#proxy-modes">1</a></sup> sent to the backend. P-8’s behavior is determined by how the backend responds to these requests.</p>
</li>
<li>
<p>The backend must tell P-8 to push data. Regardless of how clients are connected, data may be pushed to them by making an HTTP POST request to P-8’s private control API (<code class="language-plaintext highlighter-rouge">http://localhost:5561/publish/</code> by default). P-8 will inject this data into any client connections as necessary.</p>
</li>
</ol>
<p>To assist with integration, there are <a href="../usage/index.html#libraries">libraries</a> for many backend languages and frameworks. P-8 has no libraries on the client side because it is transparent to clients.</p>
<p><small><a name="proxy-modes">1</a>: P-8 can communicate WebSocket activity to the backend using either HTTP or WebSockets. Conversion to HTTP is generally recommended as it makes the backend easier to reason about. See <a href="../configuration/index.html#proxying">Proxying</a>.</small></p>
<h3 id="concepts">Concepts</h3>
<ul>
<li>
<p><strong>Transparency.</strong> P-8 is intended to be invisible to connecting clients. In order to achieve this, the I/O interface is lower level than most other realtime push solutions. Your backend is given complete control over the HTTP and WebSocket frames used in protocol interactions. Any content type can be processed, including binary data.</p>
</li>
<li>
<p><strong>Stateless.</strong> Realtime push systems almost always have stateful elements, making them difficult to develop and scale. P-8 attempts to manage these stateful elements itself in order to ensure backend development remains easy. When P-8 requires data from your backend server, it will act as the responsible party.</p>
</li>
<li>
<p><strong>Share nothing.</strong> The key to massive scale is horizontal scalability, and P-8 achieves this by not requiring communication between P-8 instances. Sticky sessions are not needed either, not even for long-polling. Note that this means there will sometimes be redundant communication between the P-8 tier and your backend tier, but we believe this is worth the trade for a more manageable and scalable system.</p>
</li>
<li>
<p><strong>Publish-subscribe.</strong> Not surprisingly, P-8 uses a publish-subscribe model for data transmission. This way, your backend doesn’t have to care about individual client connections. P-8 can also forward subscription information to an intermediate layer, to make a tiered publish-subscribe system possible.</p>
</li>
</ul>
<h3 id="architecture">Architecture</h3>
<p>P-8 fits well into a variety of setups, due to acting as a proxy server and as a publish-subscribe broker.</p>
<p><strong>Basic:</strong></p>
<p>The most basic setup is to put P-8 in front of a typical web service backend, where the backend publishes data directly to P-8. The web service itself might publish data in reaction to incoming requests, or there might be some kind of background process/job that publishes data.</p>
<p><img alt="arch-basic" src="../../image/arch-basic.png"/></p>
<p><br/></p>
<p><strong>With API management:</strong></p>
<p>It’s possible to combine an API management system with P-8. Most API management systems work as proxy servers as well, which means all you need to do is chain the proxies together. Place P-8 in the front, so that the API management system isn’t subjected to long-lived connections. Also, P-8 can translate WebSocket protocol to HTTP, allowing the API management system to operate on the translated data.</p>
<p><img alt="arch-apimanagement" src="../../image/arch-apimanagement.png"/></p>
<p><br/></p>
<p><strong>With message queue:</strong></p>
<p>If you have a lot of data to push, you may want to introduce an intermediate message queue. This way, backend processes can publish data once to the message queue, and the queue can relay the data via an adapter to one or more P-8 instances. P-8 is able to forward subscription information to such adapters, so that messages can be sent only to the P-8 instances that have subscribers for a given channel.</p>
<p><img alt="arch-tiered" src="../../image/arch-tiered.png"/></p>
<p><br/></p>
<p><strong>Microservices:</strong></p>
<p>In a microservice environment, P-8 makes it easy to listen for instant updates from other microservices without the need for a centralized message broker. Each microservice gets its own P-8 instance, and microservices communicate with each other via your organization’s own API contracts rather than a vendor-specific mechanism.</p>
<p><img alt="arch-microservice" src="../../image/arch-microservice.png"/></p>
<p><br/></p>
<p><strong>As a large scale CDN:</strong></p>
<p>Since P-8 instances don’t talk to each other, and message delivery can be tiered, this means P-8 instances can be geographically distributed to create a realtime push CDN. Clients can connect to the nearest regional edge server, and events can radiate out from a data source to the edges. This is essentially the goal of <a href="https://fanout.io/cloud/">Fanout</a>.</p>
<p><img alt="arch-cdn" src="../../image/arch-cdn.png"/></p>
<h3 id="why-P-8">Why P-8?</h3>
<p>P-8 is an ambitious project with two primary goals:</p>
<ul>
<li>
<p><strong>Make realtime API development easier.</strong> There are many other solutions out there that are excellent for building realtime apps, but few are useful within the context of <em>APIs</em>. For example, you can’t use Socket.io to build Twitter’s streaming API. A new kind of project is needed in this case.</p>
</li>
<li>
<p><strong>Make realtime push behavior delegable.</strong> The reason there isn’t a realtime push CDN yet is because the standards and practices necessary for delegating to a third party in a transparent way are not yet established. P-8 is more than just another realtime push solution; it represents the next logical step in the evolution of realtime web architectures.</p>
</li>
</ul>
<p>To really understand P-8, you need to think of it as more like a gateway than a message queue. P-8 does not persist data and it is agnostic to your application’s data model. Your backend provides the mapping to whatever that data model is. Tools like Kafka and RabbitMQ are complementary.</p>
<p>P-8 is also agnostic to your API definition. Clients don’t necessarily subscribe to “channels” or recieve “messages”. Clients make HTTP requests or send WebSocket frames, and your backend decides the meaning of those inputs. P-8 could perhaps be awkwardly described as “a proxy server that enables web services to delegate the handling of realtime push primitives”.</p>
<p>On a practical level, there are many benefits to P-8 that you don’t see anywhere else:</p>
<ul>
<li>
<p>The proxy design allows P-8 to fit nicely within an API stack. This means it can inherit other facilities from your REST API, such as authentication, logging, throttling, etc. It can be combined with an API management system.</p>
</li>
<li>
<p>As your API scales, a multi-tiered architecture will become inevitable. With P-8 you can easily do this from the start.</p>
</li>
<li>
<p>It works well with microservices. Each microservice can have its own P-8 instance. No central bus needed.</p>
</li>
<li>
<p>Hot reload. Restarting the backend doesn’t disconnect clients.</p>
</li>
<li>
<p>In the case of WebSocket messages being proxied out as HTTP requests, the messages may be handled statelessly by the backend. Messages from a single connection can even be load balanced across a set of backend instances.</p>
</li>
</ul>
<h3 id="scalability">Scalability</h3>
<p>P-8 is horizontally scalable. Instances don’t talk to each other, and sticky routing is not needed. Backends must publish data to all instances to ensure clients connected to any instance will receive the data. Most of the backend libraries support configuring more than one P-8 instance, so that a single publish call will send data to multiple instances at once.</p>
<p>Optionally, ZeroMQ PUB/SUB can be used to send data to P-8 instead of using HTTP POST. When this method is used, subscription information is forwarded to each publisher, such that data will only be published to instances that have listeners.</p>
<p>As for vertical scalability, P-8 has been tested with up to <a href="https://github.com/fanout/P-8-c1m">1 million concurrent connections</a> running on a single DigitalOcean droplet with 8 CPU cores. In practice, you may want to plan for fewer connections per instance, depending on your throughput. The new connection accept rate is about 800/sec (though this also depends on the speed of your backend), and the message throughput is about 8,000/sec. The important thing is that P-8 is horizontally scalable which is effectively limitless.</p>
<h3 id="fault-tolerance">Fault-tolerance</h3>
<p>P-8 was designed to be reliable enough to front an entire web service if necessary. In order to reduce the risk of bugs affecting non-push traffic, P-8 is split into multiple processes. The proxy capability is handled by <code class="language-plaintext highlighter-rouge">P-8-proxy</code>, while the publish-subscribe capability is handled by <code class="language-plaintext highlighter-rouge">P-8-handler</code>. The idea is that <code class="language-plaintext highlighter-rouge">P-8-proxy</code> should be stable and rarely modified, while active feature development should primarily take place in <code class="language-plaintext highlighter-rouge">P-8-handler</code>. If <code class="language-plaintext highlighter-rouge">P-8-handler</code> ever fails, regular traffic will continue to flow.</p>
<p>See <a href="../advanced/index.html#multiple-processes">Multiple processes</a>.</p>
<h2 id="support">Support</h2>
<p>If you have a question about P-8, feel free to post on the community forum:</p>
<ul>
<li><a href="https://community.fastly.com/c/P-8/12">Forum</a></li>
</ul>
<p>Other resources:</p>
<ul>
<li>
<p><a href="https://github.com/P-8-project/P-8/issues">Issue tracker</a></p>
</li>
<li>
<p><a href="https://github.com/P-8-project/P-8">Source on GitHub</a></p>
</li>
<li>
<p>Twitter: <a href="https://twitter.com/P-8org">@P-8org</a></p>
</li>
</ul>
<p>Commercial support is provided by <a href="https://fastly.com/">Fastly</a>. Please contact <a href="mailto:support@fastly.com">support@fastly.com</a>.</p>
<h2 id="license">License</h2>
<p>P-8 is licensed under the Apache License, Version 2.0. See the <a href="https://github.com/P-8-project/P-8/blob/main/LICENSE">LICENSE</a> file.</p>
</section>
</div><!-- content -->
<div class="div"></div>
<section class="cta">
<div class="wrapper">
<aside class="github">
<a href="https://github.com/P-8-project/P-8"><img src="../../image/github.svg"/></a>
<section class="meta">
<iframe allowtransparency="true" frameborder="0" height="20" scrolling="0" src="http://ghbtns.com/github-btn.html?user=fanout&amp;repo=P-8&amp;type=watch&amp;count=true" width="110"></iframe>
<iframe allowtransparency="true" frameborder="0" height="20" scrolling="0" src="http://ghbtns.com/github-btn.html?user=fanout&amp;repo=P-8&amp;type=fork&amp;count=true" width="95"></iframe>
</section>
<a class="link" href="https://github.com/P-8-project/P-8">https://github.com/P-8-project/P-8</a>
</aside>
</div>
</section><!-- cta -->
<footer class="primary wrapper">
<nav class="primary" id="top" role="navigation">
<aside class="links">
<a href="../../index.html">Home</a>
<a href="index.html">Docs</a>
<a href="https://github.com/P-8-project/P-8">GitHub</a>
</aside>
<a class="logo" href="../../index.html"><img src="../../image/logo.png"/></a>
</nav>

</footer>
<script src="../../js/main.js"></script>
<script async="" defer="" src="https://buttons.github.io/buttons.js"></script>
</body>
</html>
